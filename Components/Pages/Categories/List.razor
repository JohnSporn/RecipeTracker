@page "/categories/list"

@using Microsoft.AspNetCore.Components.QuickGrid;

@inject ICategoryService CategoryService
@inject NavigationManager Navigation

<MudGrid>
    <MudItem xs="12">
        <MudText Typo="Typo.h5">Categories</MudText>
    </MudItem>
    <MudItem xs="12">
        <!--Maybe change this to data grid to look better on mobile.-->
        <MudTable T="Category" Items="Categories" Hover="true" RowClass="cursor-pointer" OnRowClick="CategoryClicked" SortLabel="Sort By">
            <HeaderContent>
                <MudTh>
                    <MudTableSortLabel SortBy="new Func<Category, object>(x => x.Name)">Category</MudTableSortLabel>
                </MudTh>
            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="Category">@context.Name</MudTd>
            </RowTemplate>
        </MudTable>
    </MudItem>
    <MudItem xs="12" Class="d-flex justify-end">
        <MudFab Color="Color.Primary" StartIcon="@Icons.Material.Filled.Add" Href="/categories/category-form" />
    </MudItem>
</MudGrid>

@code {
    private IEnumerable<Category> Categories = new List<Category>();
    private int Id;

    protected override async Task OnInitializedAsync()
    {
        Categories = await CategoryService.CategoryGetAll();
    }

    private void CategoryClicked(TableRowClickEventArgs<Category> tableRowClickEventArgs)
    {
        Id = tableRowClickEventArgs.Item!.Id;
        Navigation.NavigateTo($"/categories/category-form/{Id}");
    }
}
